<div class="main-container" *ngIf="isFormVisible">
  <h2 class="page-title" *ngIf="workerName">{{ workerName }}</h2>
  <form [formGroup]="demandeForm" (ngSubmit)="onSubmit()" class="form-grid">
    <mat-form-field appearance="fill">
      <mat-label>Type de congé</mat-label>
      <mat-select formControlName="type" required>
        <mat-option *ngFor="let type of typesConge" [value]="type">{{ type }}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Date de début</mat-label>
      <input matInput [matDatepicker]="startPicker" formControlName="startDate" required>
      <mat-datepicker-toggle matIconSuffix [for]="startPicker"></mat-datepicker-toggle>
      <mat-datepicker #startPicker></mat-datepicker>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Date de fin</mat-label>
      <input matInput [matDatepicker]="endPicker" formControlName="endDate" required>
      <mat-datepicker-toggle matIconSuffix [for]="endPicker"></mat-datepicker-toggle>
      <mat-datepicker #endPicker></mat-datepicker>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Motif</mat-label>
      <textarea matInput formControlName="reason" required></textarea>
    </mat-form-field>

    <div class="attachment-container">
      <button mat-stroked-button color="accent" (click)="fileInput.click()" class="upload-button" [disabled]="!isWorkerSelected">
        Joindre un document
      </button>
      <input type="file" #fileInput (change)="onFileChange($event)" style="display: none;" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
      <span class="attachment-label" *ngIf="demandeForm.get('attachment')?.value">{{ demandeForm.get('attachment')?.value.name }}</span>
    </div>

    <div class="button-group">
      <button mat-raised-button color="primary" [disabled]="demandeForm.invalid || !isWorkerSelected" type="submit">Envoyer la demande</button>
      <button mat-stroked-button color="warn" (click)="resetCin()">Retapper CIN</button>
    </div>
  </form>
  <div class="feedback-label" *ngIf="demandeForm.errors">{{ demandeForm.errors | json }}</div>
</div>